{% extends 'owners/base.html' %}

{% block title %}Dashboard{% endblock %}

{% block extra_styles %}
<style>
    .table-container {
        position: relative;
        width: 100%;
        height: 500px;
        border: 1px solid #ddd;
        margin-top: 20px;
    }
    .table-item {
        position: absolute;
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background-color: gray;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        cursor: pointer;
        font-size: 0.8rem;
        padding: 5px;
    }
    .table-item.order {
        background-color: green;
    }
    .table-item.edit-mode {
        cursor: move;
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Dashboard</h1>
</div>
<div class="table-container" id="tableContainer" data-restaurant-id="{{ restaurant.id }}">
    {% for table in tables %}
    <div class="table-item {% if table.order %}order{% endif %}" 
        data-table-id="{{ table.id }}" 
        style="left: {{ table.position_x }}px; top: {{ table.position_y }}px;">
        <span>{{ table.id }}</span>
        {% if table.order %}
        <div class="order-details">
            <p>Order: {{ table.order.id }}</p>
            <p>Status: {{ table.order.status }}</p>
            <p>Total: {{ table.order.total_value }}</p>
            <button class="btn btn-sm btn-success mark-order-finished" data-order-id="{{ table.order.id }}">Finish Order</button>
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>
<button id="editModeToggle" class="btn btn-primary">Move Tables</button>
<button id="addTable" class="btn btn-secondary">Add Table</button>
{% endblock %}

{% block extra_scripts %}
{% load static %}
<script src="{% static 'owners/dashboard.js' %}"></script>
{% endblock %}
